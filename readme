â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â° 12:45 PM â€” FETCH DATA           â”‚
â”‚  â€¢ Get latest 10â€“15 days of DIA prices       â”‚
â”‚  â€¢ Save new days into the database           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â° 12:49 PM â€” UPDATE STREAKS       â”‚
â”‚  â€¢ Look at last 2 closing prices of DIA       â”‚
â”‚  â€¢ If today's close > yesterday's â†’ UP DAY    â”‚
â”‚      â†’ increase positive streak (+1)          â”‚
â”‚      â†’ reset negative streak (0)              â”‚
â”‚  â€¢ If today's close < yesterday's â†’ DOWN DAY  â”‚
â”‚      â†’ increase negative streak (+1)          â”‚
â”‚      â†’ reset positive streak (0)              â”‚
â”‚  â€¢ Save streak state in DB (strategy_state)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            â° 12:50 PM â€” TRADE ACTIONS        â”‚
â”‚  â€¢ Read current streak from DB                â”‚
â”‚                                               â”‚
â”‚  â–¼ If DIA has gone DOWN:                      â”‚
â”‚     â”œâ”€ On 3rd day (or more): BUY UDOW (20%) 
         On 4th Day if its down : Buy UDOW (20%)   â”‚
â”‚     â”œâ”€ Always SELL SDOW (inverse ETF)         â”‚
â”‚                                               â”‚
â”‚  â–¼ If DIA has gone UP:                        â”‚
â”‚     â”œâ”€ On 1st up day: SELL UDOW                â”‚
â”‚     â”œâ”€ On 3rd up day: BUY SDOW (20%)  
         On 4th day up : Buy SDOW(20%)        â”‚
â”‚                                               â”‚
â”‚  â€¢ Save trades in DB (trade_order table)      â”‚
â”‚  â€¢ Send buy/sell orders to Alpaca API         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ðŸ’¾ Logs & State Updated                â”‚
â”‚  â€¢ All trades recorded in Postgres            â”‚
â”‚  â€¢ Latest streak counts saved in DB           â”‚
â”‚  â€¢ Positions can be checked via Alpaca        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜





| Time (PST)   | Task           | Description                                             |
| ------------ | -------------- | ------------------------------------------------------- |
| **12:45 PM** | Fetch Data     | Downloads DIA daily prices from Polygon                 |
| **12:49 PM** | Update Streaks | Compares last two days, updates up/down streak counters |
| **12:50 PM** | Trade          | Places buy/sell orders on Alpaca based on streak logic  |



| Day | DIA Close | Trend          | Action                  |
| --- | --------- | -------------- | ----------------------- |
| Mon | 400       | â€”              | â€”                       |
| Tue | 398       | â†“ 1st down day | nothing                 |
| Wed | 396       | â†“ 2nd down day | nothing                 |
| Thu | 392       | â†“ 3rd down day | **BUY UDOW (20%)**       |
| Fri | 389       | â†“ 4th down day | **BUY UDOW (20%) again** |
| Mon | 395       | â†‘ 1st up day   | **SELL all UDOW**        |
| Tue | 397       | â†‘ 2nd up day   | nothing                 |
| Wed | 401       | â†‘ 3rd up day   | **BUY SDOW (20%)**      |
| Thu | 399       | â†“ 1st down day | **SELL SDOW**           |



fly commands:
 fly scale count 0 -a stocks-bot          # stop
fly secrets set MY_SECRET=value -a stocks-bot
fly deploy -a stocks-bot                  # redeploy with new code/secrets
fly scale count 1 -a stocks-bot           # start again
 
